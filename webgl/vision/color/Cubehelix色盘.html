<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>CIE Lab 和 CIE Lch 颜色</title>
    </head>
    <body>
        <canvas id="canvas" width="256" height="256"></canvas>

        <script type="module">
            import { cubehelix } from "../../common/lib/cubehelix/cubehelix.js";

            const canvas = document.querySelector("canvas");
            const ctx = canvas.getContext("2d");
            ctx.translate(0, 256);
            ctx.scale(1, -1);

            const color = cubehelix(); // 构造cubehelix色盘颜色映射函数
            const T = 2000;

            function update(t) {
                const p = 0.5 + 0.5 * Math.sin(t / T);
                ctx.clearRect(0, -256, 512, 512);
                const { r, g, b } = color(p);
                ctx.fillStyle = `rgb(${255 * r},${255 * g},${255 * b})`;
                ctx.beginPath();
                ctx.rect(20, -20, 480 * p, 40);
                ctx.fill();
                window.ctx = ctx;
                requestAnimationFrame(update);
            }
            update(0);
        </script>
    </body>
</html>
